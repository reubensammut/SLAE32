#include <stdio.h>
#include<stdlib.h>
#include <string.h>

#define EGG "\xDE\xAD\xC0\xDE"

unsigned char egghunter[] = 
"\xfc\x31\xd2\x89\xd3\x66\x81\xcb\xff\x0f\x43\x89\xd0\xb0\xba\xcd\x80\x3c\xf2\x74"
"\xf0\xb8\xde\xad\xc0\xde\x89\xdf\xaf\x75\xeb\xaf\x75\xe8\xff\xe7";

int main(int argc, char *argv[])
{
	unsigned char *egg = malloc(80);
	int (*ret)() = (int(*)())egghunter;
	
	memcpy(egg, EGG, 4);
	egg += 4;

	memcpy(egg, EGG, 4);
	egg += 4;

	memcpy( egg, 
		"\x31\xc0\x89\xc3\x99\xb0\x04\xb3\x01\x6a\x0a\x66\x68\x3a\x29\x68\x6d\x65\x21\x20",
		20 );
	egg += 20;

	memcpy( egg, 
		"\x68\x75\x6e\x64\x20\x68\x75\x20\x66\x6f\x68\x2e\x20\x59\x6f\x68\x6c\x65\x74\x65",
		20 );
	egg += 20;

	memcpy( egg, 
		"\x68\x63\x6f\x6d\x70\x68\x20\x69\x73\x20\x68\x68\x75\x6e\x74\x68\x65\x67\x67\x20",
		20 );
	egg += 20;

	memcpy( egg, 
		"\x68\x54\x68\x65\x20\x89\xe1\xb2\x2b\xcd\x80\xb0\x01\x31\xdb\xcd\x80",
		17 );

	ret();

	return 0;
}
